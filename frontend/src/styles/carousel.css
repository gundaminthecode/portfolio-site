/* styles/carousel.css */
/* Carousel Styles */

@import 'keen-slider/keen-slider.min.css';

.swiper-slide,
.keen-slider__slide {
  display: grid;
  place-items: center;
  
  --card-h: clamp(280px, 90vw, 380px);
}

.swiper:not(.swiper-vertical) .swiper-slide {
  width: var(--card-w) !important;
  height: auto !important;
}
.swiper.swiper-vertical .swiper-slide {
  height: var(--card-h) !important;
  width: auto !important;
}

.keen-slider__slide {
  width: var(--card-w) !important;
  height: var(--card-h) !important;
}

.project-slide.project-slide--carousel {
  width: 100% !important;
  height: 100% !important;
  box-sizing: border-box;
  overflow: hidden;
}

:root {
  --carousel-max-width: 500px;
  --carousel-height: 20vh;

  --card-w: min(92vw, 460px);
  --card-h: clamp(300px, 56vh, 560px);
}

.scene {
  position: relative;
  width: 100%;
  max-width: var(--carousel-max-width);
  height: var(--carousel-height);
  margin: 0 auto;
  perspective: 1000px;

  --carousel-height: clamp(240px, 40vh, 400px);
}

.scene {
  --carousel-height: clamp(220px, 36vh, 400px);
  --carousel-face-h: 60%;
  height: var(--carousel-height);
  position: relative;
}

.scene .carousel.keen-slider {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  overflow: visible;
  transform-style: preserve-3d;
}

.carousel.keen-slider > .keen-slider__slide.carousel__cell {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100% !important;
  height: var(--carousel-face-h) !important;
  transform-origin: 50% 50%;
  backface-visibility: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  will-change: transform;
}

.scene .carousel.keen-slider {
  height: 100%;
  transform-style: preserve-3d;
}

.carousel__card {
  width: 100%;
  height: 100%;
  max-width: min(92%, 420px);
  display: flex;
  flex-direction: column;
  justify-content: center;
  border-radius: 12px;
  overflow: hidden;
}

@media (max-width: 900px) {
  .scene { --carousel-height: clamp(200px, 34vh, 420px); --carousel-face-h: 56%; }
  .carousel__card { max-width: min(94%, 360px); }
}
@media (max-width: 600px) {
  .scene { --carousel-height: clamp(180px, 38vh, 360px); --carousel-face-h: 50%; }
  .carousel__card { max-width: min(96%, 320px); }
}
@media (max-width: 380px) {
  .scene { --carousel-height: clamp(160px, 42vh, 320px); --carousel-face-h: 46%; }
  .carousel__card { max-width: min(98%, 290px); }
}

/* Smaller, less intrusive carousel on mobile/touch */
@media (pointer: coarse) {
  .scene {
    --carousel-height: clamp(140px, 28dvh, 300px);
    --carousel-face-h: 46%;
  }
  .carousel__card { max-width: min(96%, 300px); }
}

/* Narrow phones */
@media (max-width: 600px) {
  .scene {
    --carousel-height: clamp(140px, 30dvh, 300px);
    --carousel-face-h: 46%;
  }
}
@media (max-width: 380px) {
  .scene {
    --carousel-height: clamp(120px, 28dvh, 260px);
    --carousel-face-h: 44%;
  }
}

/* Slightly tighter spacing around the carousel */
.scene { margin-block: 0.5rem 1rem; }

.project-slide.project-slide--carousel:hover {
  animation: hex-bob 1.4s ease-in-out infinite;
}

@media (prefers-reduced-motion: reduce) {
  .project-slide.project-slide--carousel:hover { animation: none; }
}

.carousel { --slide-h: clamp(220px, 50vh, 520px); }
.carousel__viewport { overflow: hidden; }
.carousel__track {
  display: grid;
  grid-auto-flow: column;
  grid-auto-columns: 100%;
  gap: var(--space-3);
  align-items: center;
}
.carousel__slide { position: relative; }
.carousel__slide img, .carousel__slide picture {
  width: 100%;
  height: var(--slide-h);
  object-fit: cover;
}
.carousel__nav {
  display: flex;
  justify-content: center;
  gap: var(--space-3);
  margin-top: var(--space-3);
}
.carousel__button {
  inline-size: clamp(36px, 4vw, 48px);
  block-size: clamp(36px, 4vw, 48px);
}

.carousel.keen-slider > .keen-slider__slide.carousel__cell {
  width: 100% !important;
  height: var(--carousel-face-h) !important;
}

.project-slide.project-slide--carousel {
  overflow: hidden;
}
.project-slide.project-slide--carousel,
.project-slide.project-slide--carousel * {
  min-width: 0;
  max-width: 100%;
  overflow-wrap: anywhere;
  word-break: break-word;
}

.project-slide.project-slide--carousel .project-slide__title {
  font-size: var(--fs-600);
  line-height: 1.2;
  margin: 0 0 0.35rem 0;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  overflow: hidden;
}
.project-slide.project-slide--carousel .project-slide__desc {
  font-size: var(--fs-300);
  line-height: 1.35;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 3;
  line-clamp: 3;
  overflow: hidden;
}
.project-slide.project-slide--carousel .project-slide__meta,
.project-slide.project-slide--carousel .project-slide__tags {
  font-size: calc(var(--fs-300) * 0.95);
  line-height: 1.3;
}

@media (max-width: 600px) {
  .project-slide.project-slide--carousel { padding: 0.75rem; font-size: 0.88em; }
  .project-slide.project-slide--carousel .project-slide__title { 
    -webkit-line-clamp: 2;
    line-clamp: 2;
  }
  .project-slide.project-slide--carousel .project-slide__desc  { 
    -webkit-line-clamp: 3;
    line-clamp: 3;
  }
}

@media (prefers-reduced-motion: reduce) {
  .project-slide.project-slide--carousel:hover { animation: none; }
}

@media (pointer: coarse) {
  .carousel {
    touch-action: pan-y;           /* let the page scroll vertically */
    -ms-touch-action: pan-y;
  }
}
